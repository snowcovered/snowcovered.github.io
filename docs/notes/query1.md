# 查询无套利定价

> 论文名：The Design of Arbitrage-Free Data Pricing Schemes

## 内容概述

文章主要讲了查询无套利定价中的两种情况——APS(定价函数是p(Q,D) )和QPS(定价函数是p(Q))，它们的区别在于：

* 前者是针对某个特定数据集的定价，需要考虑的是query在何种程度上把这个数据集与其他数据集区分开，用冲突集的偏序关系来定义无套利；

* 后者针对所有数据集，需要考虑的是query在何种程度上把所有数据集 ***划分*** ,因而使用划分的偏序来定义无套利（哪个划分得更细）。

除此之外，作者还用信息论知识（借用各种信息熵），将数据库视为随机变量，来描述无套利关系(留待以后深入学习)。

文章最后提到了可以只在集合族的子集上使用无套利条件（这并不会在子集上违背无套利）。

## 什么是查询无套利

1. 对于查询$Q_1$,$Q_2$,如果$Q_1$解释的信息只是$Q_2$的子集，那么$Q_1$的价格不能高于$Q_2$

2. 对于查询$Q_1$,$Q_2$,$Q_3=Q_1,Q_2$。（这里我们可以认为$Q_3$是一个查询组合，相当于连续查了$Q_1$和$Q_2$），那么有$p(Q_3) \leq p(Q_1)+p(Q_2)$,否则我们便没有理由去购买这个组合包。

## 思考：如何避免查询上的无套利？

我们首先要定义查询的价值，比如说查询A=5元，查询B=10元。但是查询的价值并不像普通物品一样可以指定，因为一些查询可以 ***决定*** 另一些查询：

>
我们称查询 $Q_2$ 在数据库 $D$ 下确定查询 $Q_1$，记作 $D \vdash Q_2 \twoheadrightarrow Q_1$，当且仅当对于任意数据库 $D'$，若 $Q_2(D) = Q_2(D')$，则必有 $Q_1(D') = Q_1(D)$。

简单来说就是，**一些查询解释的信息完全包含了另一些查询**（当然，这个APS讨论某个数据集D与剩余数据集的“划分”上的）。比如这个数据集某一维是1(可能取值是1-20)，那么我查询这一维是否小于3就决定了查询是否小于7。

我们还可以发现APS的特点，那就是定价和数据集相关，如果这一维是8，那么查询否小于3就不能决定查询否小于7。

所以在APS中，就考虑查询**冲突集**的偏序关系。

类似的，在QPS中，我们需要考虑**划分**的偏序关系。

## APS

考虑一个查询组 $Q \in \mathcal{B}(L)$、一个数据库 $D \in \mathcal{I}$，并令 $E = Q(D)$。我们定义：

$$
S_Q(E) = \{ D' \in \mathcal{I} \mid Q(D') = E \}, \quad \overline{S}_Q(E) = \{ D' \in \mathcal{I} \mid Q(D') \neq E \}.
$$

易证，用冲突集的并半格可以很好描述answer的决定关系。



设 $p(Q, E) = f(\bar{S}_Q(E))$ 是一个定价函数，其中 $f$ 是一个集合函数。则以下两个命题等价：

  * $p$ 不具有捆绑套利；

  * $f$ 在每一个半格 $\mathcal{S}^L_D$ 上是次可加的。

### APS无套利条件

设 $f$ 是一个单调且次可加的集合函数。则函数
$$
p(Q, E) = f(\overline{S}_Q(E))
$$
是一个依赖于查询结果的定价函数，并且它是无套利的，作者给出了3个例子：
1. **加权覆盖函数**：

   $$
   \sum_{D:Q(D) \neq E} w_D.
   $$

2. **上确界函数**：

   $$
   \sup_{D:Q(D) \neq E} w_D.
   $$

3. **预算受限的加权覆盖函数**（其中 $B \ge 0$）：

   $$
   \min\\{B,\; \sum_{D:Q(D)\neq E} w_D \\}
   $$

其中$w_D\geq 0$为$D \in I$的权重。


> 作者说明了无套利的一个trade off,那就是在APS的很多情况中，查询无套利定价很接近数据库的价值。（因为你这个查询很容易把这个数据库区分（或者说泄漏）出来）

## DPS

> 这里不考虑**意外套利**

DPS的$Q_1$决定$Q_2$与APS类似，只不过是在全体数据集上的。（所以也叫划分）

### 决定与细分的等价

$Q_1$决定$Q_2$当且仅当$Q_1$相较于$Q_2$细分了数据库的集合。(很显然，他们基本上就是一个概念)。

设 $f$ 是定义在 $\Pi^{L}_{I}$ 上的一个单调且次可加函数。  
则

$$
p(Q) = f(P_Q)
$$
是一个**与实例无关的定价函数**，并且不存在**捆绑套利**或**信息套利**。

---

### DPS无套利条件

我们也可以从APS出发给出另一个推论，形式化地，我们定义价格向量
$\vec{p}(Q) \;=\; \langle \, p(Q, Q(D)) \;\mid\; D \in I \,\rangle .$
然后我们通过在上述向量上计算另一个函数
$g : \mathbb{R}^{|I|}_{+} \;\to\; \mathbb{R}_{+}$
来得到一个**与实例无关的定价函数**，使得
$p(Q) \;=\; g(\vec{p}(Q)).$
设 $p(Q, E)$ 是一个无套利的定价函数。  
如果 $g$ 是一个**单调且次可加**的函数，那么

$$
p(Q) = g(\vec{p}(Q))
$$

就是一个无套利的、与实例无关的定价函数。


>作者举个几个用单调、次可加集合函数构造的例子，此处不赘述。


## 支撑集性质

作者证明了选一个小的支撑集$C \subseteq I$有助于定价（关键是不破坏无套利性质）：

APS:设 $C \subseteq I$。  
如果 $f$ 是一个单调且次可加的集合函数，  
则定价函数

$$
p(Q, E) = f(\overline{S}_Q(E) \cap C)
$$
是无套利的。

DPS:设 $C \subseteq I$。  
如果 $f$ 是定义在**划分半格**上的一个单调且次可加函数，  
则定价函数

$$
p(Q) = f(P_Q \cap C)
$$
是无套利的。


